<head>
  <!-- <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet" /> -->

  <link rel="stylesheet" href="./node_modules/video.js/dist/video-js.css" />
  <link
    rel="stylesheet"
    href="./node_modules/videojs-hls-quality-selector/dist/videojs-hls-quality-selector.css"
  />
</head>

<body>
  <video-js
    id="vid1"
    width="1280"
    height="720"
    class="vjs-default-skin"
    controls
  >
  </video-js>
  <ul class="menu">
    <li onclick="lowHandle()">480</li>
    <li onclick="highHandle()">720</li>
  </ul>
  <button onclick="getVideo()">获取当前分辨率</button>

  <!-- <script src="https://vjs.zencdn.net/8.16.1/video.min.js"></script> -->
  <!-- <script src="https://cdn.bootcdn.net/ajax/libs/video.js/8.17.1/video.min.js"></script> -->
  <script src="./node_modules/video.js/dist/video.min.js"></script>
  <script src="./node_modules/videojs-hls-quality-selector/dist//videojs-hls-quality-selector.min.js"></script>
  <!-- <script src="https://unpkg.com/browse/@videojs/http-streaming@3.15.0/dist/videojs-http-streaming.min.js"></script> -->

  <script>
    var player = videojs("vid1", {
      muted: true,
      html5: {
        vhs: {
          withCredentials: false,
        },
      },
    });
    player.hlsQualitySelector();
    let qualityLevels = player.qualityLevels();

    player.src({
      withCredentials: false,
      type: "application/x-mpegURL",
      src: "http://ata-dev.oss-cn-beijing.aliyuncs.com/multi_stream_20241212.m3u8?x-oss-process=hls%2Fsign&OSSAccessKeyId=LTAI5tGGRdCdjVUZ5FMF8MNo&Expires=2049350512&Signature=bXiC1cEZCA0sVVkh8MFDpx0VKak%3D",
    });
    player.ready(function () {
      console.log("play准备好了");
      // tech() will log warning without any argument
      //   var tech = myPlayer.tech(true);
      //   console.log("myPlayer.tech:", tech);

      player.play();
    });
    player.on("loadeddata", () => {
      console.log("监听流变化");
      var vhs = player.tech().vhs;
      //   console.log("vhs:", vhs);
      console.log("vhs.playlists.main:", vhs.playlists.main);
      console.log("vhs.playlists.media:", vhs.playlists.media());
    });
    function lowHandle() {
      console.log("切换低分辨率");
      qualityLevels.selectedIndex_ = 0;
      qualityLevels.trigger({ type: "change", selectedIndex: 0 });
    }
    function highHandle() {
      console.log("切换高辨率");
      qualityLevels.selectedIndex_ = 1;
      qualityLevels.trigger({ type: "change", selectedIndex: 1 });
    }
    function getVideo() {
      console.log("获取当前分辨率", qualityLevels);
    }
  </script>
</body>
